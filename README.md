This is a code created by George Fokianos, that I only contributed some corrections and additions
